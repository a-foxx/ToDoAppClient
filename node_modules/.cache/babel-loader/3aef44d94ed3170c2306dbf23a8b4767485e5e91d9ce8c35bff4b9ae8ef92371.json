{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Alan/Documents/Itcareerswitch/codecademy/projects/to-do-app/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Alan/Documents/Itcareerswitch/codecademy/projects/to-do-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Alan/Documents/Itcareerswitch/codecademy/projects/to-do-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import ListHeader from'./components/ListHeader';import ListItem from'./components/ListItem';import Auth from'./components/Auth';import{useCookies,withCookies}from'react-cookie';import validator from'validator';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(_ref){var cookies=_ref.cookies;var _useCookies=useCookies(null),_useCookies2=_slicedToArray(_useCookies,3),cookie=_useCookies2[0],setCookie=_useCookies2[1],removeCookie=_useCookies2[2];var authToken=cookie===null||cookie===void 0?void 0:cookie.AuthToken;var userEmail=cookie===null||cookie===void 0?void 0:cookie.Email;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),tasks=_useState2[0],setTasks=_useState2[1];var getData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var URL,response,json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:URL=\"\".concat(process.env.REACT_APP_SERVERURL,\"/to-do/getTodos/\").concat(userEmail);_context.prev=1;_context.next=4;return fetch(URL);case 4:response=_context.sent;_context.next=7;return response.json();case 7:json=_context.sent;setTasks(json);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);console.error(_context.t0);case 14:case\"end\":return _context.stop();}},_callee,null,[[1,11]]);}));return function getData(){return _ref2.apply(this,arguments);};}();useEffect(function(){if(authToken){getData();}},[]);// sort by date\nvar sortedTasks=tasks===null||tasks===void 0?void 0:tasks.sort(function(a,b){return new Date(a.date)-new Date(b.date);});var handleSignOut=function handleSignOut(){cookies.remove('Email',{path:'/'});cookies.remove('AuthToken',{path:'/'});};return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[!authToken&&/*#__PURE__*/_jsx(Auth,{}),authToken&&/*#__PURE__*/_jsx(ListHeader,{listName:'Holiday tick list',getData:getData,handleSignOut:handleSignOut}),/*#__PURE__*/_jsxs(\"p\",{className:\"user-email\",children:[\"Welcome back \",userEmail&&validator.escape(userEmail)?userEmail:'']}),sortedTasks===null||sortedTasks===void 0?void 0:sortedTasks.map(function(task){return/*#__PURE__*/_jsx(ListItem,{task:task,getData:getData},task.id);})]});};export default withCookies(App);","map":{"version":3,"names":["React","useEffect","useState","ListHeader","ListItem","Auth","useCookies","withCookies","validator","App","cookies","cookie","setCookie","removeCookie","authToken","AuthToken","userEmail","Email","tasks","setTasks","getData","URL","process","env","REACT_APP_SERVERURL","fetch","response","json","console","error","sortedTasks","sort","a","b","Date","date","handleSignOut","remove","path","escape","map","task","id"],"sources":["C:/Users/Alan/Documents/Itcareerswitch/codecademy/projects/to-do-app/client/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport ListHeader from './components/ListHeader'\nimport ListItem from './components/ListItem'\nimport Auth from'./components/Auth'\nimport { useCookies, withCookies } from 'react-cookie'\nimport validator from 'validator'\n\nconst App = ({cookies}) => {\n  const [cookie, setCookie, removeCookie] = useCookies(null)\n  const authToken = cookie?.AuthToken\n  const userEmail = cookie?.Email\n  const [tasks, setTasks] = useState(null)\n  \n  const getData = async () => {\n    const URL = `${process.env.REACT_APP_SERVERURL}/to-do/getTodos/${userEmail}`;\n    try {\n      const response = await fetch(URL);\n      const json = await response.json();\n      setTasks(json);\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  useEffect(() => {\n    if (authToken) {\n      getData()\n    }}, [])\n\n  // sort by date\n  const sortedTasks = tasks?.sort((a, b) => new Date(a.date) - new Date(b.date))\n\n  const handleSignOut = () => {\n    cookies.remove('Email', {path: '/'})\n    cookies.remove('AuthToken', {path: '/'})\n  }\n\n  return (\n    <div className='app'>\n      {!authToken && <Auth />}\n      {authToken && \n      <ListHeader listName={'Holiday tick list'} getData={getData} handleSignOut={handleSignOut}/>\n       }\n       <p className='user-email'>Welcome back {userEmail && validator.escape(userEmail) ? userEmail : ''}</p>\n      {sortedTasks?.map((task) => {return <ListItem key={task.id} task={task} getData={getData} />})}\n    </div>\n  );\n}\n\nexport default withCookies(App);\n"],"mappings":"mfAAA,MAAOA,MAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAOC,WAAU,KAAM,yBAAyB,CAChD,MAAOC,SAAQ,KAAM,uBAAuB,CAC5C,MAAOC,KAAI,KAAK,mBAAmB,CACnC,OAASC,UAAU,CAAEC,WAAW,KAAQ,cAAc,CACtD,MAAOC,UAAS,KAAM,WAAW,yFAEjC,GAAMC,IAAG,CAAG,QAANA,IAAG,MAAkB,IAAbC,QAAO,MAAPA,OAAO,CACnB,gBAA0CJ,UAAU,CAAC,IAAI,CAAC,4CAAnDK,MAAM,iBAAEC,SAAS,iBAAEC,YAAY,iBACtC,GAAMC,UAAS,CAAGH,MAAM,SAANA,MAAM,iBAANA,MAAM,CAAEI,SAAS,CACnC,GAAMC,UAAS,CAAGL,MAAM,SAANA,MAAM,iBAANA,MAAM,CAAEM,KAAK,CAC/B,cAA0Bf,QAAQ,CAAC,IAAI,CAAC,wCAAjCgB,KAAK,eAAEC,QAAQ,eAEtB,GAAMC,QAAO,6FAAG,0JACRC,GAAG,WAAMC,OAAO,CAACC,GAAG,CAACC,mBAAmB,4BAAmBR,SAAS,wCAEjDS,MAAK,CAACJ,GAAG,CAAC,QAA3BK,QAAQ,qCACKA,SAAQ,CAACC,IAAI,EAAE,QAA5BA,IAAI,eACVR,QAAQ,CAACQ,IAAI,CAAC,CAAC,iFAEfC,OAAO,CAACC,KAAK,aAAO,CAAC,oEAExB,kBATKT,QAAO,2CASZ,CAEDnB,SAAS,CAAC,UAAM,CACd,GAAIa,SAAS,CAAE,CACbM,OAAO,EAAE,CACX,CAAC,CAAC,CAAE,EAAE,CAAC,CAET;AACA,GAAMU,YAAW,CAAGZ,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAEa,IAAI,CAAC,SAACC,CAAC,CAAEC,CAAC,QAAK,IAAIC,KAAI,CAACF,CAAC,CAACG,IAAI,CAAC,CAAG,GAAID,KAAI,CAACD,CAAC,CAACE,IAAI,CAAC,GAAC,CAE9E,GAAMC,cAAa,CAAG,QAAhBA,cAAa,EAAS,CAC1B1B,OAAO,CAAC2B,MAAM,CAAC,OAAO,CAAE,CAACC,IAAI,CAAE,GAAG,CAAC,CAAC,CACpC5B,OAAO,CAAC2B,MAAM,CAAC,WAAW,CAAE,CAACC,IAAI,CAAE,GAAG,CAAC,CAAC,CAC1C,CAAC,CAED,mBACE,aAAK,SAAS,CAAC,KAAK,WACjB,CAACxB,SAAS,eAAI,KAAC,IAAI,IAAG,CACtBA,SAAS,eACV,KAAC,UAAU,EAAC,QAAQ,CAAE,mBAAoB,CAAC,OAAO,CAAEM,OAAQ,CAAC,aAAa,CAAEgB,aAAc,EAAE,cAE3F,WAAG,SAAS,CAAC,YAAY,WAAC,eAAa,CAACpB,SAAS,EAAIR,SAAS,CAAC+B,MAAM,CAACvB,SAAS,CAAC,CAAGA,SAAS,CAAG,EAAE,GAAK,CACtGc,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEU,GAAG,CAAC,SAACC,IAAI,CAAK,CAAC,mBAAO,KAAC,QAAQ,EAAe,IAAI,CAAEA,IAAK,CAAC,OAAO,CAAErB,OAAQ,EAAtCqB,IAAI,CAACC,EAAE,CAAkC,EAAC,CAAC,GAC1F,CAEV,CAAC,CAED,cAAenC,YAAW,CAACE,GAAG,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}